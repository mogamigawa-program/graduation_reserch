{% extends "base.html" %}
{% block title %}INNER JOINの実行例ページ{% endblock %}
{% block content %}
<div class="nav-buttons">
    <a href="/basic/join/inner_join/study" class="prev">◀ 前へ</a>
    <a href="/basic/join/inner_join/practice" class="next">次へ ▶</a>
</div>
<div class="learning-container">
    <h1>INNER JOINの実行例</h1>

    <!-- productsテーブル -->
    <table class="example-table">
        <caption>products</caption>
        <tr>
            {% for col in products_desc %}
                <th class="products-col">{{ col[0] }}</th>
            {% endfor %}
        </tr>
        {% for row in products_data %}
            <tr>
                {% for item in row %}
                    <td class="products-cell">{{ item }}</td>
                {% endfor %}
            </tr>
        {% endfor %}
    </table>

    <!-- customersテーブル -->
    <table class="example-table">
        <caption>customers</caption>
        <tr>
            {% for col in customers_desc %}
                <th class="customers-col">{{ col[0] }}</th>
            {% endfor %}
        </tr>
        {% for row in customers_data %}
            <tr>
                {% for item in row %}
                    <td class="customers-cell">{{ item }}</td>
                {% endfor %}
            </tr>
        {% endfor %}
    </table>

    {% if inner_join_result %}
        <h2>INNER JOINの結果</h2>

        <p><strong>実行クエリ:</strong></p>
        <div class="code-block">
<pre>
SELECT products.product_id, products.product_name, customers.customer_id, customers.order_date
FROM products
INNER JOIN customers ON products.product_id = customers.product_id;
</pre>
        </div>

        <p><strong>解説:</strong></p>
        <p>
            INNER JOINは、両テーブルで結合キーが一致する行だけを結びつけます。<br>
            今回は <code>products.product_id = customers.product_id</code> で一致するレコードのみを抽出しています。
        </p>

        <table class="example-table">
            <tr>
                {% for col in columns.split(',') %}
                    <th
                        {% if 'products.' in col.strip() %} class="products-col"{% endif %}
                        {% if 'customers.' in col.strip() %} class="customers-col"{% endif %}
                    >
                        {{ col.strip() }}
                    </th>
                {% endfor %}
            </tr>
            {% for row in inner_join_result %}
                <tr>
                    {% for item in row %}
                        <td
                            {% if 'products.' in columns.split(',')[loop.index0].strip() %} class="products-cell"{% endif %}
                            {% if 'customers.' in columns.split(',')[loop.index0].strip() %} class="customers-cell"{% endif %}
                        >
                            {{ item }}
                        </td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
    {% endif %}
</div>

<div class="nav-buttons">
    <a href="/basic/join/inner_join/study" class="prev">◀ 前へ</a>
    <a href="/basic/join/inner_join/practice" class="next">次へ ▶</a>
</div>

{% endblock %}
