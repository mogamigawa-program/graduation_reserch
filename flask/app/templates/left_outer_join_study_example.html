{% extends "base.html" %}
{% block title %}LEFT OUTER JOINの実行例ページ{% endblock %}
{% block content %}

<div class="learning-container">
    <!-- ナビゲーションボタン（上） -->
    <div class="nav-buttons">
        <a href="/basic/join/left_outer_join/study" class="prev">◀ 前へ</a>
        <a href="/basic/join/left_outer_join/practice" class="next">次へ ▶</a>
    </div>

    <h1>LEFT OUTER JOINの実行例</h1>

    <!-- productsテーブルの中身を表示 -->
    <table class="example-table">
        <caption>products</caption>
        <tr class="products-col">
            <th>商品ID</th>
            <th>商品名</th>
            <th>価格</th>
            <th>在庫数</th>
            <th>ステータス</th>
        </tr>
        <tr class="products-col">
            {% for col in products_desc %}
                <th>{{ col[0] }}</th>
            {% endfor %}
        </tr>
        {% for row in products_data %}
            <tr class="products-cell">
                {% for item in row %}
                    <td>{{ item }}</td>
                {% endfor %}
            </tr>
        {% endfor %}
    </table>

    <!-- customersテーブルの中身を表示 -->
    <table class="example-table">
        <caption>customers</caption>
        <tr class="customers-col">
            <th>購入者ID</th>
            <th>商品ID</th>
            <th>購入日</th>
        </tr>
        <tr class="customers-col">
            {% for col in customers_desc %}
                <th>{{ col[0] }}</th>
            {% endfor %}
        </tr>
        {% for row in customers_data %}
            <tr class="customers-cell">
                {% for item in row %}
                    <td>{{ item }}</td>
                {% endfor %}
            </tr>
        {% endfor %}
    </table>

    {% if left_outer_join_result %}
        <h2>LEFT OUTER JOINの結果</h2>

        <p><strong>実行クエリ:</strong></p>
        <div class="code-block">
            SELECT products.product_id, products.product_name, customers.customer_id, customers.order_date<br>
            FROM products<br>
            LEFT OUTER JOIN customers ON products.product_id = customers.product_id;
        </div>

        <p><strong>解説:</strong></p>
        <p>LEFT OUTER JOINを使用すると、左側のテーブル（ここでは<code>products</code>）の全ての行が保持され、右側のテーブル（<code>customers</code>）に一致する行がない場合は<code>NULL</code>が入ります。<br>
        そのため、productsテーブルの全ての行が結果に表示され、一部のcustomersテーブルに対応するデータがない場合はNULLが含まれる行が表示されます。</p>

        <table class="example-table">
            <tr>
                {% for col in columns.split(',') %}
                    <th
                        class="{% if 'products.' in col.strip() %}products-col{% elif 'customers.' in col.strip() %}customers-col{% endif %}">
                        {{ col.strip() }}
                    </th>
                {% endfor %}
            </tr>
            {% for row in left_outer_join_result %}
                <tr>
                    {% for item in row %}
                        <td
                            class="{% if 'products.' in columns.split(',')[loop.index0].strip() %}products-cell{% elif 'customers.' in columns.split(',')[loop.index0].strip() %}customers-cell{% endif %}">
                            {{ item }}
                        </td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
    {% endif %}

    <!-- ナビゲーションボタン（下） -->
    <div class="nav-buttons">
        <a href="/basic/join/left_outer_join/study" class="prev">◀ 前へ</a>
        <a href="/basic/join/left_outer_join/practice" class="next">次へ ▶</a>
    </div>

</div>

{% endblock %}
