{% extends "base.html" %}
{% block title %}DELETE文（全レコード削除、条件付き削除） 演習{% endblock %}
{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
{% endblock %}
{% block content %}

<div class="nav-buttons">
    <a href="/basic/delete/all/example" class="prev">◀ 前へ</a>
    <a href="/quiz/delete_all_records" class="next">次へ ▶</a>
</div>

<div class="learning-container">
    <h1>DELETE文（全レコード削除、条件付き削除） - 演習</h1>

    <section>
        <h2>問題</h2>
        <p>
            以下の <code>{{ table_name }}</code> テーブルから、データを削除してみましょう。<br>
            <strong>WHERE句を使った削除</strong>と、<strong>WHERE句を省略した削除</strong>の両方を試してみましょう。
        </p>
    </section>

    <section>
        <h2>現在のテーブル</h2>
        <table class="db-table">
            <tr>
                {% for row in desc %}
                    <th>{{ row[0] }}</th>
                {% endfor %}
            </tr>
            {% if table %}
                {% for row in table %}
                <tr>
                    {% for item in row %}
                        <td>{{ item }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            {% else %}
                <tr><td colspan="3" style="text-align:center;">（データなし）</td></tr>
            {% endif %}
        </table>
    </section>

    <section>
        <h2>SQLを入力して実行</h2>
        <p>以下のフォームにSQLを入力し、「実行」ボタンを押してください。</p>

        <form method="post" action="/basic/delete/all-records/practice">
            <textarea name="sql_query" class="sql-input" rows="5" placeholder="例：DELETE FROM {{ table_name }} WHERE grade = 'A';"></textarea>
            <div class="button-group">
                <button type="submit" name="action" value="run" class="run-btn">実行</button>
                <button type="submit" name="action" value="init" class="init-btn">テーブルを初期化</button>
            </div>            
        </form>

        {% if message %}
        <div class="result-message {{ 'success' if success else 'error' }}">
            {{ message }}
        </div>
        {% endif %}
    </section>

    <section>
        <h2>ヒント</h2>
        <ul>
            <li><code>WHERE</code>を省略すると、テーブルの全データが削除されます。</li>
            <li>テーブル構造は残るため、再びINSERTでデータを追加できます。</li>
        </ul>
    </section>

    <section>
        <h2>正答例</h2>
        <details>
            <summary>クリックして確認</summary>
            <div class="code-block"><code>DELETE FROM employees;</code></div>
            <div class="code-block"><code>DELETE FROM employees WHERE grade = 'A';</code></div>
            <div class="code-block"><code>DELETE FROM employees WHERE grade = 'B' AND grade = 'C';</code></div>
        </details>
    </section>
</div>

<div class="nav-buttons">
    <a href="/basic/delete/all/example" class="prev">◀ 前へ</a>
    <a href="/quiz/delete_all_records" class="next">次へ ▶</a>
</div>

{% endblock %}
