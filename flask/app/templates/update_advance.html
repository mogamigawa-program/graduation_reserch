{% extends "base.html" %}
{% block title %}UPDATE関数の学習ページ（高度版）{% endblock %}
{% block content %}

<div class="container">
    <div class="nav-buttons">
        <a href="/basic/update/multiple-columns/example" class="prev">◀ 前へ</a>
        <a href="/quiz/update_multiple_columns" class="next">次へ ▶</a>
    </div>
    <h1>UPDATE関数（実践）</h1>

    <p><strong>このページでは、SQLクエリを自由に記述して実行できます。</strong></p>
    <p style="color: red;"><strong>UPDATE文を使って、データを更新してみましょう！</strong></p>
    <p>以下のテキストボックスにクエリを入力し、「クエリを実行」をクリックしてください。</p>

    <!-- productsテーブルの中身を表示 -->
    <h2>productsテーブルの内容</h2>
    <table class="table">
        <caption>products</caption>
        <thead>
            <tr>
                {% for col in products_desc %}
                    <th>{{ col[0] }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for row in products_data %}
                <tr>
                    {% for item in row %}
                        <td>{{ item }}</td>
                    {% endfor %}
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- ヒント -->
    <div class="hints">
        <h2>ヒント</h2>
        
        <details>
            <summary class="btn retry">ヒント1</summary>
            <p>UPDATE文は、テーブル内のデータを更新するためのSQL文です。<br>UPDATEの後ろには適用させるテーブル名を入れます。</p>
            <p>例：UPDATE products ...;</p>
        </details>

        <details>
            <summary class="btn retry">ヒント2</summary>
            <p>SETを使って更新するカラムと値を指定します。</p>
            <p>例：UPDATE products SET price = 85000 ;</p>
        </details>

        <details>
            <summary class="btn retry">ヒント3</summary>
            <p>WHERE句を使うことで、特定の条件を満たすレコードだけを更新できます。</p>
            <p>例：UPDATE products SET stock_quantity = 120 WHERE product_id = 1;</p>
        </details>

        <details>
            <summary class="btn retry">ヒント4</summary>
            <p>複数のカラムを一度に更新することもできます。</p>
            <p>例：UPDATE products SET price = 85000, stock_quantity = 110 WHERE product_id = 1;</p>
        </details>

        <details>
            <summary class="btn retry">ヒント5</summary>
            <p style="color: red;">注意：</p><p>クエリを実行した後、データが更新されるため、適用前と適用後の結果を確認しましょう。</p>
        </details>
    </div>

    {% if error_message %}
        <p class="error">{{ error_message }}</p>
    {% endif %}

    <form method="POST">
        <label for="query">SQLクエリ:</label>
        <p style="color: red;"><strong>クエリの最後には「;」をつけよう！</strong></p>
        <textarea id="query" name="query" rows="5" required>{{ query if query }}</textarea>
        <br>
        <button type="submit" class="btn btn-primary">クエリを実行</button>
    </form>

    {% if query %}
        <h2>実行したクエリ</h2>
        <p><code>{{ query }}</code></p>
    {% endif %}

    {% if query_result %}
        <h2>更新後のproductsテーブル</h2>
        <table class="table">
            <thead>
                <tr>
                    {% for col in products_desc %}
                        <th>{{ col[0] }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in query_result %}
                    <tr>
                        {% for item in row %}
                            <td>{{ item }}</td>
                        {% endfor %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

    <div class="nav-buttons">
        <a href="/basic/update/multiple-columns/example" class="prev">◀ 前へ</a>
        <a href="/quiz/update_multiple_columns" class="next">次へ ▶</a>
    </div>
</div>



{% endblock %}
